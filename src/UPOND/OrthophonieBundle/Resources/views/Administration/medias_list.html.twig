

{% extends "UPONDOrthophonieBundle::layout.html.twig" %}

{% block title %}
    Gestion multimédias - {{ parent() }}
{% endblock %}

{% block orthophonie_body %}

<div name="intitule">
    <h1>Gestion des ressources multimédias</h1>
</div>

    <h3>Liste des images</h3>
    <form action="{{ path('upond_orthophonie_administration_ressources_manager_images_update_simple')}}" method="POST" class="Multimedias">
        <div class="row">
            <div class="col-sm-4 col-md-4 col-lg-4">
                <select id="strat_filter" class="form-control" name="strategie_filter">
                    <option value="0"></option>
                    {% for strategie in listStrategie %}
                        <option value="{{ strategie.getNom }}">{{ strategie.getNom }}</option>
                    {% endfor %}
                </select>

            </div>

            <div class="col-sm-4 col-md-4 col-lg-4">
                <input type="submit" name="validate" value="Enregister nouveaux noms" class="btn btn-success">
            </div>

        </div>
    <table id="mytab" class='table table-striped container'>
        <thead>
        <th>Image</th>
        <th id="strat_col">Strategie</th>
        <th>Son</th>
        <th>Texte</th>
        <th>Action</th>
        </thead>
        <tbody>
        {% for multimedia in listMultimedias %}
            <tr>
                <td>
                    <img src="{{ asset(multimedia.getImage) }}" width="300px" class="img-thumbnail "/>
                    <input class="" type="hidden" name="image[]" value="{{ multimedia.getIDMultimedia }}">
                </td>
                <td>{{ multimedia.getStrategie.getNom }}</td>
                <td>
                    <audio controls>
                        <source src="{{ asset(multimedia.getSon) }}" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                    <input class="" type="hidden" name="son[]" value="{{ multimedia.getIDMultimedia }}">
                </td>
                <td>
                    <input class="" type="text" name="text[]" value="{{ multimedia.getNom }}">
                </td>
                <td>
                    <a title="Modifier média" class="btn btn-primary" href="{{ path('upond_orthophonie_administration_ressources_manager_images_update')}}?media_id={{ multimedia.getIDMultimedia }}"><i class="fa fa-edit"></i></a>
                </td>

            </tr>
        {% endfor %}
        </tbody>
    </table>
</form>
{% endblock %}

{% block javascripts_complement %}

  <script>
    $( document ).ready(function() {
        var table = $('#mytab').DataTable({
            dom: "lrtip",
            "bDestroy": true
        });
        $('#strat_filter').on( 'keyup change', function () {
            if(this.value == 0){
                table.column(1)
                        .search('')
                        .draw();
            }
            else if ((table.column(1).search() !== this.value) ) {
                table.column(1)
                        .search( this.value )
                        .draw();
            }
        } );
        $('[name="ListMedecins"]').each(function () {
            idMedecin = $(this).val();
            idPatient = $(this).attr("idPatient");
            $('[name=idMedecin][idpatient='+idPatient+']').val(idMedecin);
        });

        $('[name="ListMedecins"]').change(function () {
            idMedecin = $(this).val();
            idPatient = $(this).attr("idPatient");
            $('[name=idMedecin][idpatient='+idPatient+']').val(idMedecin);
        });
    });

   </script>
{% endblock %}